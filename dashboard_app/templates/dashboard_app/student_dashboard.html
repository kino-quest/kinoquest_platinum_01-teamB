{% extends 'dashboard_app/base.html' %}
{% block title %}ダッシュボード | スノトラ{% endblock %}
{% block content %}
<div class="flex min-h-screen bg-gray-50 p-6">
    <!-- 左カラム -->
    <div class="w-2/3 p-4 bg-white rounded-xl shadow-md">
        <!-- インストラクター名 -->
        <div class="mb-6">
            <h2 class="text-xl font-semibold text-gray-800">今日 : {{ today|date:"Y 年 n 月 j 日" }}</h2>
        </div>
        <!-- 予定カレンダー -->
        <div>
            <h3 class="text-lg font-medium text-gray-700 mb-2">予定カレンダー</h3>
            <div id="calendar" class="bg-white p-4 rounded shadow-md"></div>
        </div>
    </div>
    <!-- 右カラム -->
    <div class="w-1/3 p-4 ml-6 bg-white rounded-xl shadow-md">
        <h3 class="text-lg font-medium text-gray-700 mb-4">予約日一覧</h3>

        {% if preferences %}
            <ul class="space-y-4">
                {% for pref in preferences %}
                    <li class="p-4 bg-gray-100 rounded-lg">
                        {{ pref.lesson_detail.lesson_date|date:"Y年m月d日" }}
                        /
                        {{ pref.lesson_detail.get_time_slot_display }}
                        <br>
                        {{ pref.lesson_detail.ski_resort.resort_name }}
                        <br>
                        担当: {{ pref.lesson_detail.instructor.username }}
                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p class="text-gray-500">現在の予約はありません。</p>
        {% endif %}
    </div>

</div>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const calendarEl = document.getElementById('calendar');
        const calendar = new FullCalendar.Calendar(calendarEl, {
            locale: 'ja',
            initialView: 'dayGridMonth',
            events: '/dashboard/student-events/',  // ← 学習者の予約を取得
            height: 'auto',
            headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,listWeek'
            },
            eventColor: '#3b82f6',
        });
        calendar.render();
    });
</script>

{% endblock %}